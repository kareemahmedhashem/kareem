<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<title>Ù„Ø¹Ø¨Ø© Ø´Ø¨ÙƒØ© Ø§Ù„ØªÙ…ÙˆÙŠÙ‡</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    direction: rtl;
    background: #f0f0f0;
    margin-top: 50px;
  }
  #game {
    display: inline-block;
    border: 3px solid #333;
    background: #fff;
  }
  .row {
    display: flex;
  }
  .cell {
    width: 60px;
    height: 60px;
    border: 1px solid #999;
    box-sizing: border-box;
    position: relative;
  }
  .player {
    background: #4caf50;
  }
  .trap {
    background: #e53935;
  }
  .trap.hidden {
    background: #fff;
  }
  .invisible {
    opacity: 0.5;
  }
  #info {
    margin-top: 15px;
    font-size: 18px;
  }
  button {
    margin-top: 20px;
    padding: 10px 20px;
    font-size: 18px;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>Ù„Ø¹Ø¨Ø© Ø´Ø¨ÙƒØ© Ø§Ù„ØªÙ…ÙˆÙŠÙ‡</h1>
<p>Ø§Ø³ØªØ®Ø¯Ù… Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø£Ø³Ù‡Ù… Ù„ØªØ­Ø±Ùƒ Ø§Ù„Ù„Ø§Ø¹Ø¨ ğŸŸ©</p>
<p>Ø§Ø¶ØºØ· Ø²Ø± "ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡" Ù„ØªØ¬Ù†Ø¨ Ø§Ù„ÙØ®Ø§Ø® ğŸ”¥ Ù„Ù…Ø¯Ø© 5 Ø«ÙˆØ§Ù†ÙŠ</p>

<div id="game"></div>

<div id="info"></div>
<button id="cloakBtn">ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡</button>

<script>
  const gridSize = 5;
  const game = document.getElementById('game');
  const info = document.getElementById('info');
  const cloakBtn = document.getElementById('cloakBtn');

  let playerPos = {x: 0, y: 0};
  let traps = [];
  let cloakActive = false;
  let gameOver = false;

  // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ©
  const cells = [];
  for (let y = 0; y < gridSize; y++) {
    const row = document.createElement('div');
    row.className = 'row';
    const rowCells = [];
    for (let x = 0; x < gridSize; x++) {
      const cell = document.createElement('div');
      cell.className = 'cell';
      row.appendChild(cell);
      rowCells.push(cell);
    }
    game.appendChild(row);
    cells.push(rowCells);
  }

  // ÙˆØ¶Ø¹ ÙØ®Ø§Ø® Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
  function placeTraps() {
    traps = [];
    while (traps.length < 5) {
      let tx = Math.floor(Math.random() * gridSize);
      let ty = Math.floor(Math.random() * gridSize);
      // Ù„Ø§ ØªØ¶Ø¹ ÙØ® Ø¹Ù†Ø¯ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø£Ùˆ ÙØ® Ù…ÙˆØ¬ÙˆØ¯
      if ((tx !== playerPos.x || ty !== playerPos.y) && !traps.some(t => t.x === tx && t.y === ty)) {
        traps.push({x: tx, y: ty});
      }
    }
  }

  // Ø±Ø³Ù… Ø§Ù„Ø´Ø¨ÙƒØ©
  function draw() {
    for (let y = 0; y < gridSize; y++) {
      for (let x = 0; x < gridSize; x++) {
        cells[y][x].className = 'cell';
        cells[y][x].textContent = '';
      }
    }
    // Ø±Ø³Ù… Ø§Ù„ÙØ®Ø§Ø® (Ù…Ø®ÙÙŠØ© Ø£Ùˆ Ø¸Ø§Ù‡Ø±Ø© Ø­Ø³Ø¨ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡)
    traps.forEach(t => {
      if (cloakActive) {
        cells[t.y][t.x].classList.add('trap', 'hidden');
      } else {
        cells[t.y][t.x].classList.add('trap');
      }
    });
    // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨
    cells[playerPos.y][playerPos.x].classList.add('player');
    if (cloakActive) {
      cells[playerPos.y][playerPos.x].classList.add('invisible');
    }
  }

  // ØªØ­Ø±Ùƒ Ø§Ù„Ù„Ø§Ø¹Ø¨
  function movePlayer(dx, dy) {
    if (gameOver) return;

    const newX = playerPos.x + dx;
    const newY = playerPos.y + dy;

    if (newX < 0 || newX >= gridSize || newY < 0 || newY >= gridSize) return;

    playerPos = {x: newX, y: newY};

    // ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ÙØ®
    if (!cloakActive && traps.some(t => t.x === newX && t.y === newY)) {
      gameOver = true;
      info.textContent = "ğŸ’¥ ÙˆÙ‚Ø¹Øª ÙÙŠ ÙØ®! Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!";
      alert("ğŸ’¥ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.");
    } else {
      info.textContent = cloakActive ? "ğŸ›¡ï¸ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡ Ù…ÙØ¹Ù‘Ù„! Ø£Ù†Øª Ù…Ø­Ù…ÙŠ." : "ØªØ­Ø±Ùƒ Ø¨Ø­Ø°Ø±!";
    }

    draw();
  }

  // Ø§Ø³ØªÙ…Ø¹ Ù„Ù…ÙØ§ØªÙŠØ­ Ø§Ù„Ø£Ø³Ù‡Ù…
  window.addEventListener('keydown', (e) => {
    if (gameOver) return;

    switch(e.key) {
      case 'ArrowUp': movePlayer(0, -1); break;
      case 'ArrowDown': movePlayer(0, 1); break;
      case 'ArrowLeft': movePlayer(-1, 0); break;
      case 'ArrowRight': movePlayer(1, 0); break;
    }
  });

  // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡
  cloakBtn.addEventListener('click', () => {
    if (gameOver) return;
    if (cloakActive) {
      alert("ğŸ›¡ï¸ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡ Ù‚ÙŠØ¯ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ø§Ù„ÙØ¹Ù„!");
      return;
    }
    cloakActive = true;
    info.textContent = "ğŸ›¡ï¸ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡ Ù…ÙØ¹Ù‘Ù„! Ø£Ù†Øª Ù…Ø­Ù…ÙŠ Ù„Ù…Ø¯Ø© 5 Ø«ÙˆØ§Ù†ÙŠ.";
    draw();

    setTimeout(() => {
      cloakActive = false;
      info.textContent = "ØªÙ… Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„ØªÙ…ÙˆÙŠÙ‡ØŒ Ø§Ø­Ø°Ø± Ø§Ù„ÙØ®Ø§Ø®!";
      draw();
    }, 5000);
  });

  placeTraps();
  draw();
  info.textContent = "Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„ØªØ­Ø±Ùƒ!";

</script>

</body>
</html>
