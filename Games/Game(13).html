<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>ğŸ§  Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø§Ù„Ù…ØªØ§Ù‡Ø©</title>
  <style>
    body {
      font-family: sans-serif;
      direction: rtl;
      text-align: center;
      background: #222;
      color: white;
      margin-top: 20px;
    }
    #grid {
      display: grid;
      grid-template-columns: repeat(10, 40px);
      grid-template-rows: repeat(10, 40px);
      gap: 2px;
      justify-content: center;
      margin: 20px auto;
    }
    .cell {
      width: 40px;
      height: 40px;
      background: #ccc;
    }
    .player {
      background: limegreen;
    }
    .obstacle {
      background: #333;
    }
    .exit {
      background: lightgreen;
    }
    #status {
      font-size: 20px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h1>ğŸƒâ€â™‚ï¸ Ø§Ù„Ù‡Ø±ÙˆØ¨ Ù…Ù† Ø§Ù„Ù…ØªØ§Ù‡Ø©</h1>
<div id="grid"></div>
<div id="status">Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø³Ù‡Ù… Ù„Ù„ØªØ­Ø±Ùƒ Ù†Ø­Ùˆ Ø§Ù„Ù…Ø®Ø±Ø¬!</div>

<script>
  const gridSize = 10;
  const grid = document.getElementById("grid");
  let cells = [];
  let playerPos = { x: 0, y: 0 };
  let exitPos = { x: 9, y: 9 };
  let obstacles = [];

  // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø¨ÙƒØ©
  function createGrid() {
    grid.innerHTML = '';
    cells = [];
    for (let y = 0; y < gridSize; y++) {
      const row = [];
      for (let x = 0; x < gridSize; x++) {
        const cell = document.createElement("div");
        cell.classList.add("cell");
        grid.appendChild(cell);
        row.push(cell);
      }
      cells.push(row);
    }
  }

  function draw() {
    // ØªÙØ±ÙŠØº ÙƒÙ„ Ø§Ù„Ø®Ù„Ø§ÙŠØ§
    for (let y = 0; y < gridSize; y++) {
      for (let x = 0; x < gridSize; x++) {
        cells[y][x].className = 'cell';
      }
    }

    // Ø±Ø³Ù… Ø§Ù„Ø¹ÙˆØ§Ø¦Ù‚
    obstacles.forEach(pos => {
      cells[pos.y][pos.x].classList.add("obstacle");
    });

    // Ø±Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙˆØ§Ù„Ù…Ø®Ø±Ø¬
    cells[playerPos.y][playerPos.x].classList.add("player");
    cells[exitPos.y][exitPos.x].classList.add("exit");
  }

  function movePlayer(dx, dy) {
    const newX = playerPos.x + dx;
    const newY = playerPos.y + dy;

    if (
      newX >= 0 && newX < gridSize &&
      newY >= 0 && newY < gridSize &&
      !isObstacle(newX, newY)
    ) {
      playerPos = { x: newX, y: newY };
      draw();

      if (playerPos.x === exitPos.x && playerPos.y === exitPos.y) {
        status("ğŸ‰ ÙØ²Øª! ÙˆØµÙ„Øª Ù„Ù„Ù…Ø®Ø±Ø¬!");
        clearInterval(exitTimer);
        document.removeEventListener('keydown', handleKeys);
      }
    }
  }

  function isObstacle(x, y) {
    return obstacles.some(pos => pos.x === x && pos.y === y);
  }

  function randomFreeCell() {
    let x, y;
    do {
      x = Math.floor(Math.random() * gridSize);
      y = Math.floor(Math.random() * gridSize);
    } while ((x === playerPos.x && y === playerPos.y) || isObstacle(x, y));
    return { x, y };
  }

  function generateObstacles(count = 20) {
    obstacles = [];
    for (let i = 0; i < count; i++) {
      let pos = randomFreeCell();
      obstacles.push(pos);
    }
  }

  function changeExit() {
    exitPos = randomFreeCell();
    draw();
    status("â±ï¸ ØªÙ… ØªØºÙŠÙŠØ± Ù…ÙƒØ§Ù† Ø§Ù„Ù…Ø®Ø±Ø¬! Ø£Ø³Ø±Ø¹!");
  }

  function status(msg) {
    document.getElementById('status').textContent = msg;
  }

  function handleKeys(e) {
    switch (e.key) {
      case "ArrowUp": movePlayer(0, -1); break;
      case "ArrowDown": movePlayer(0, 1); break;
      case "ArrowLeft": movePlayer(-1, 0); break;
      case "ArrowRight": movePlayer(1, 0); break;
    }
  }

  // Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©
  createGrid();
  generateObstacles();
  draw();

  // ØªØºÙŠÙŠØ± Ø§Ù„Ù…Ø®Ø±Ø¬ ÙƒÙ„ 10 Ø«ÙˆØ§Ù†Ù
  const exitTimer = setInterval(() => {
    changeExit();
  }, 10000);

  document.addEventListener('keydown', handleKeys);
</script>

</body>
</html>
